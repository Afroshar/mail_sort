Несколько десятков отправителей пишут письма в Яндекс. Их письма попадают в файл в формате Unix mailbox. Это обычный текстовый файл, длина строк в котором не превышает 1000 байт, а письма следуют одно за другим.
Пример файла прилагается (unix.mailbox). Признак начала письма - строка, начинающаяся словом From, сразу за которым следует один пробел. Сразу за ним следует e-mail отправителя, за ним -пробел и какая-то дополнительная информация. Писем очень много, некоторые из них могут иметь большой объем. Объём входного файла может составлять много гигабайт. При этом количество разных отправителей не превышает 100.

Напишите программу на Perl/Python, которая преобразует этот файл во множество файлов того же формата, по одному файлу на каждого отправителя. Все письма одного и того же отправителя должны быть в одном файле. При написании программы учтите:

1) объем RAM ограничен, поэтому не нужно хранить в памяти «лишних» структур и данных, без которых можно обойтись;
2) открытие файла - очень трудоёмкая операция, поэтому каждый файл должен открываться или закрываться только один раз;
3) в программе нельзя использовать сторонние модули;
4) решение ожидается в виде одного относительно короткого файла (меньше или около 50 строк на Perl/Python). Не нужно усложнять решение каким-то дополнительным функционалом, проверками данных и т. п.